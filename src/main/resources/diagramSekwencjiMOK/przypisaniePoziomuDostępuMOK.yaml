  @startuml
    actor UżytkownikUwierzytelniony as U
    participant Strona
    participant StronaUżytkownika
    participant FormularzPrzyznawaniaPoziomuDostępu
    control AccountService
    entity Admin
    entity Owner
    entity Manager
    entity AccessLevelMapping

  U -> Strona: Naciśnij przycisk "Wyświetl listę użytkowników"
  Strona -> AccountService: Wczytaj listę kont użytkowników
  AccountService --> Strona: Wczytano listę kont użytkowników
  U -> Strona: Wybierz konto użytkownika
  Strona -> StronaUżytkownika: Wczytaj szczegóły konta użytkownika
  StronaUżytkownika -> AccountService: Wczytaj szczegóły konta użytkownika
  AccountService --> StronaUżytkownika: Wczytano szczegóły konta użytkownika

  U -> StronaUżytkownika: Naciśnij przycisk "Dodaj poziom dostępu"
  StronaUżytkownika -> FormularzPrzyznawaniaPoziomuDostępu: Załaduj formularz edycji dodania poziomu dostępu

  group << transaction>> RW, READ COMMITTED, zakres: \n- wykonanie zapytania do bazy danych,\n- dodanie rekordu w tabeli access_level_mapping,\n- dodanie rekordu w tabeli admin, ,\n- dodanie rekordu w tabeli owner,\n- dodanie rekordu w tabeli manager
  FormularzPrzyznawaniaPoziomuDostępu -> AccountService: Załaduj dane do formularz edycji poziomu dostępu
    activate AccountService
    AccountService -> AccessLevelMapping: Pobierz dane do formularz edycji poziomu dostępu
    AccessLevelMapping --> AccountService: Pobrano dane do formularz edycji poziomu dostępu
  AccountService --> FormularzPrzyznawaniaPoziomuDostępu: Załadowano dane do formularza poziomu dostępu
  
    opt wybierz poziom dostępu Admin
      U -> FormularzPrzyznawaniaPoziomuDostępu: Wprowadź "Admin" w polu dodawania roli
      FormularzPrzyznawaniaPoziomuDostępu -> AccountService: Dodaj role Admin do konta użytkownika
      alt użytkownik posiada już role Admin
      AccountService --> FormularzPrzyznawaniaPoziomuDostępu: Użytkownik posiada już role Admin
      AccountService --> StronaUżytkownika: Poziom dostępu Admin nie został przypisany
      else
      AccountService -> Admin: Utwórz obiekt Admin
    activate Admin
      Admin -> AccessLevelMapping: Utwórz obiekt AccessLevelMapping
    activate AccessLevelMapping
      AccessLevelMapping --> Admin: Obiekt AccessLevelMapping został utworzony
    deactivate AccessLevelMapping
      Admin --> AccountService: Obiekt Admin został utworzony
      AccountService --> StronaUżytkownika: Poziom dostępu Admin został przypisany
      deactivate Admin
      end
    else wybierz poziom dostępu Manager
      U -> FormularzPrzyznawaniaPoziomuDostępu: Wprowadź "Manager" w polu dodawania roli
      FormularzPrzyznawaniaPoziomuDostępu -> AccountService: Dodaj role Manager do konta użytkownika
      alt użytkownik posiada już role Manager
      AccountService --> FormularzPrzyznawaniaPoziomuDostępu: Użytkownik posiada już role Manager
      AccountService --> StronaUżytkownika: Poziom dostępu Manager nie został przypisany
      else
      AccountService -> Manager: Utwórz obiekt Manager
      activate Manager
      Manager -> AccessLevelMapping: Utwórz obiekt AccessLevelMapping
    activate AccessLevelMapping
      AccessLevelMapping --> Manager: Obiekt AccessLevelMapping został utworzony
    deactivate AccessLevelMapping
      Manager --> AccountService: Obiekt Manager został utworzony
      AccountService --> StronaUżytkownika: Poziom dostępu Manager został przypisany
      deactivate Manager
      end
    else wybierz poziom dostępu Owner
      U -> FormularzPrzyznawaniaPoziomuDostępu: Wprowadź "Owner" w polu dodawania roli
      FormularzPrzyznawaniaPoziomuDostępu -> AccountService: Dodaj role Owner do konta użytkownika
      alt użytkownik posiada już role Owner
      AccountService --> FormularzPrzyznawaniaPoziomuDostępu: Użytkownik posiada już role Owner
      AccountService --> StronaUżytkownika: Poziom dostępu Owner nie został przypisany
      else
      AccountService -> Owner: Utwórz obiekt Owner
      activate Owner
      Owner -> AccessLevelMapping: Utwórz obiekt AccessLevelMapping
    activate AccessLevelMapping
      AccessLevelMapping --> Owner: Obiekt AccessLevelMapping został utworzony
    deactivate AccessLevelMapping
      Owner --> AccountService: Obiekt Owner został utworzony
      AccountService --> StronaUżytkownika: Poziom dostępu Owner został przypisany
      deactivate Owner
      end
    end    
    end
    @enduml