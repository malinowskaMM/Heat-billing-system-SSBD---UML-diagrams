  @startuml
    actor UżytkownikUwierzytelniony as U
    participant Strona
    participant FormularzEdycjiAdresuEmail
    control AccountService
    entity Account

  U -> Strona: Naciśnij przycisk "Edytuj adres e-mail"
  Strona -> FormularzEdycjiAdresuEmail: Załaduj formularz edycji adresu e-mail
  FormularzEdycjiAdresuEmail --> AccountService: Załaduj dane do formularz edycji adresu e-mail
    activate AccountService
  AccountService --> FormularzEdycjiAdresuEmail: Załadowano dane do formularza edycji adresu e-mail
  U -> FormularzEdycjiAdresuEmail: Wprowadź nowy adres e-mail
  FormularzEdycjiAdresuEmail -> AccountService: <<transaction>> Zmień adres e-mail użytkownika

    note right: RW, READ COMMITTED, zakres: wykonanie zapytania do bazy danych,\n edycja rekordu tabeli account

    alt format wprowadzonego adresu e-mail jest niepoprawny
    AccountService --> FormularzEdycjiAdresuEmail: Format wprowadzonego adresu e-mail jest niepoprawny
    FormularzEdycjiAdresuEmail --> Strona: Pokaż ostrzeżenie o niepoparwnym formacie wprowadzonego adresu e-mail
    else wprowadzony adres e-mail jest już przypisany do istniejącego konta
    AccountService --> FormularzEdycjiAdresuEmail: Wprowadzony adres e-mail jest już przypisany do istniejącego konta
    FormularzEdycjiAdresuEmail --> Strona: Pokaż ostrzeżenie o przypisaniu adresu e-mail do istniejącego konta
    else wprowadzony adres e-mail jest poprawny
    group inicjonowane na podstawie przycisku "Wyślij link autoryzujący"
    AccountService --> U: Wyślij wiadomość pocztową w linkiem autoryzującym czynność zmiany adresu e-mail
      alt autoryzacja czynności zmiany adresu e-mail nie została uzyskana
      AccountService --> Strona: Pokaż ostrzeżenie o nieudanej zmianie adresu e-mail
      else autoryzacja czynności zmiany adresu e-mail została uzyskana
      AccountService -> Account: Zmień pole email obiektu Account
      activate Account
      AccountService --> Strona: Dane osobowe zostały zaktualizowane
      end
    end
    end
    
    @enduml