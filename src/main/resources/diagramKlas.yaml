@startuml
  
  Owner "1" -- "many" HotWaterEntry
  Manager "1" -- "many" HotWaterEntry
  Manager "many" -- "1" HeatDistributionCentrePayoff
  Building "1" *-- "many" Place
  Place "1" -- "many" MonthPayoff
  Place "many" -- "1" Account
  Place "1" -- "many" Advance
  Place "1" -- "many" AnnualBalance
  Place "1" -- "many" HotWaterEntry
  Advance "1"  *-- "0..1" HotWaterAdvance
  Advance "1" *-- "1" HeatingPlaceAndCommunalAreaAdvance
  MonthPayoff "many" -- "1" Account
  PastQuarterHotWaterPayoff -- Place
  Account <|-- Owner
  Account <|-- Manager
  HeatDistributionCentre "1" -- "many" HeatDistributionCentrePayoff
  HeatDistributionCentre "1" o-- "many" Building
  
class HeatDistributionCentre {
id: Integer

addBuilding(building: Building): void
}


class HeatDistributionCentrePayoff {
id: Integer
date: LocalDate
consumption: BigDecimal
consumptionCost: BigDecimal
heatingAreaFactor: BigDecimal

getId(): Integer
getDate(): LocalDate
getConsumption(): BigDecimal
getConsumptionCost(): BigDecimal
getHeatingAreaFactor(): BigDecimal
}


class Building {
id: Integer
totalArea: BigDecimal
communalAreaAggregate: BigDecimal
address: String

addPlace(place: Place): void

getId(): Integer
getTotalArea(): BigDecimal
getCommunalAreaAggregate(): BigDecimal
getAddress(): String
}


class Place {
id: Integer
area: BigDecimal
hotWaterConnection: Boolean
centralHeatingConnection: Boolean
predictedHotWaterConsumption: BigDecimal

getId(): Integer
getArea(): BigDecimal
getHotWaterConnection(): Boolean
getCentralHeatingConnection(): Boolean
getPredictedHotWaterConsumption(): BigDecimal

setArea(area: BigDecimal): void
setHotWaterConnection(flag: Boolean): void
setCentralHeatingConnection(flag: Boolean): void
setPredictedHotWaterConsumption(predictedConsumption: BigDecimal): void
}

class HotWaterEntry {
id: Integer
date: LocalDate
entryValue: BigDecimal

getId(): Integer
getDate(): LocalDate
getEntryValue(): BigDecimal

setEntryValue(date: LocalDate, value: BigDecimal): void
}


class MonthPayoff {
id: Integer
payoffDate: LocalDate
waterHeatingUnitCost: BigDecimal
centralHeatingUnitCost: BigDecimal
hotWaterConsumption: BigDecimal

getId(): Integer
getPayoffDate(): LocalDate
getWaterHeatingUnitCost(): BigDecimal
getCentralHeatingUnitCost(): BigDecimal
getHotWaterConsumption(): BigDecimal
}

class Advance {
id: Integer
date: LocalDate

getId(): Integer
getDate(): LocalDate
}

class HotWaterAdvance {
id: Integer
hotWaterAdvanceValue: BigDecimal
calculateAdvance(): BigDecimal

getId(): Integer
getHotWaterAdvanceValue(): BigDecimal
}

class HeatingPlaceAndCommunalAreaAdvance {
id: Integer
heatingPlaceAdvanceValue: BigDecimal
heatingCommunalAreaAdvanceValue: BigDecimal
advanceChangeFactor: Float

calculateAdvance(): BigDecimal

getId(): Integer
getHeatingPlaceAdvanceValue(): BigDecimal
getHeatingCommunalAreaAdvanceValue(): BigDecimal
getAdvanceChangeFactor(): Float
}


class PastQuarterHotWaterPayoff {
id: Integer
averageConsumption: BigDecimal
daysNumberInQuarter: Integer

getId(): Integer
getAverageConsumption(): BigDecimal
getDaysNumberInQuarter(): Integer

setAverageConsumption(consumption: BigDecimal): void
setDaysNumberInQuarter(daysNumber: Integer): void
}

class AnnualBalance {
id: Integer
year: Integer
balanceHotWater: BigDecimal
balanceHeatingPlace: BigDecimal
balanceHeatingCommunalArea: BigDecimal
totalHotWaterCost: BigDecimal
totalHeatingPlaceCost: BigDecimal
totalHeatingCommunalAreaCost: BigDecimal

updateBalance(hotWater: BigDecimal, heatingPlace: BigDecimal, heatingCommunalArea: BigDecimal): void
updateTotalCost(hotWater: BigDecimal, heatingPlace: BigDecimal, heatingCommunalArea: BigDecimal): void

getId(): Integer
getYear(): Integer
getBalanceHotWater(): BigDecimal
getBalanceHeatingPlace(): BigDecimal
getBalanceHeatingCommunalArea(): BigDecimal
getTotalHotWaterCost(): BigDecimal
getTotalHeatingPlaceCost(): BigDecimal
getTotalHeatingCommunalAreaCost(): BigDecimal
}

abstract class Account {
id: String
username: String
password: String
name: String
surname: String

getId(): String
getUsername(): String
getPassword(): String
getName(): String
getSurname(): String

setUsername(username: String): void
setPassword(password: String): void
setName(name: String): void
setSurname(surname: String): void
}

class Manager {

}

class Owner {

}

note right of HeatingPlaceAndCommunalAreaAdvance
advanceChangeFactor is inserted once per quarter
end note


note right of Building
Building can have following types of connection:
  - hot water connection,
  - central heating connection,
  - hot water connection and central heating connection.
communalAreaAggregate = totalArea - sum(Place.area)
end note
  
note left of Place
Place can have following types of connection:
  - hot water connection,
  - central heating connection,
  - hot water connection and central heating connection,
  - no connection.
end note

@enduml